/*Obfuscated by JShaman.com*/var request=require('../../utils/request.js');var crypto=require('../../utils/crypto.js');const app=getApp();Page({'data':{'kjStartMoney':null,'kjEndMoney':null,'showKjBtn':![],'loadDataProgressValue':0x14,'showApp':![],'pageNO':0x0,'isLoad':![],'isRequest':![],'showHb':![],'shareInfo':null,'info':{},'modalName2':'','modalName':'','cardCur':0x0,'swiperList':[],'feedCount':'-','feedList':[]},'onLoad':function(_0x4df196){if(app['globalData']['apiInfo']==null){wx['showModal']({'title':'登录提示','content':'检查到您未登录,请先进行登录！','showCancel':![],'success':()=>{wx['navigateTo']({'url':'/pages/login/login?json='+_0x4df196['json']});}});return;}if(app['globalData']['apiInfo']['kjStartMoney']!=null&&app['globalData']['apiInfo']['kjEndMoney']!=null){if(app['globalData']['apiInfo']['kjStartMoney']!=''){this['setData']({'kjStartMoney':app['globalData']['apiInfo']['kjStartMoney']});}if(app['globalData']['apiInfo']['kjEndMoney']!=''){this['setData']({'kjEndMoney':app['globalData']['apiInfo']['kjEndMoney']});}}this['initProgressView']();let _0x352887=JSON['parse'](crypto['decrypted'](_0x4df196['json']));if(_0x352887['key']==undefined){_0x352887['key']=_0x352887['id'];}this['setData']({'info':_0x352887});let _0x42832a=_0x352887['from'];let _0x524871=this['data']['info']['type'];if(_0x524871=='拼多多'){request['getPddshowdetail'](this['data']['info']['id'],_0x58c808=>{_0x58c808['from']=_0x42832a;this['setData']({'info':_0x58c808});this['data']['info']['imgList']['forEach'](_0x59c427=>{this['data']['swiperList']['push']({'url':_0x59c427});});this['setData']({'swiperList':this['data']['swiperList']});this['showApp']();});}else if(_0x524871=='淘宝'){request['getTbshowdetail'](this['data']['info']['id'],_0xd409d1=>{_0xd409d1['from']=_0x42832a;this['setData']({'info':_0xd409d1});this['data']['info']['imgList']['forEach'](_0x1ec6ba=>{this['data']['swiperList']['push']({'url':_0x1ec6ba});});this['setData']({'swiperList':this['data']['swiperList']});this['showApp']();});}else if(_0x524871=='京东'){request['getJdshopDetail'](this['data']['info']['id'],_0x1da42c=>{_0x1da42c['from']=_0x42832a;this['setData']({'info':_0x1da42c,'shareInfo':{'appId':_0x1da42c['appId'],'path':_0x1da42c['wxPath'],'type':_0x1da42c['type'],'h5':_0x1da42c['resultH5Url'],'img':_0x1da42c['img']}});this['data']['info']['imgList']['forEach'](_0x469a8c=>{this['data']['swiperList']['push']({'url':_0x469a8c});});this['setData']({'swiperList':this['data']['swiperList']});this['showApp']();});}else if(_0x524871=='抖音'){let _0x1688cc=app['globalData']['tmpParams'];this['setData']({'info':_0x1688cc});this['data']['info']['imgList']['forEach'](_0x53d40d=>{this['data']['swiperList']['push']({'url':_0x53d40d});});this['setData']({'swiperList':this['data']['swiperList']});this['showApp']();}},'showModel2'(){this['setData']({'modalName2':'DialogModal2'});},'copyTbPwd'(){wx['setClipboardData']({'data':this['data']['shareInfo']['path'],'success':()=>{wx['showToast']({'title':'已复制','icon':'none'});},'fail':()=>{request['openApp']('wx2e2190862d71f2b0','/pages/copytxt/copytxt?json='+crypto['encrypted'](this['data']['shareInfo']['path']),_0x57bcbc=>{});}});},'showModal'(_0x48aa1f){this['requestVo'](()=>{this['setData']({'modalName':'bottomModal'});},!![]);},'hideModal'(){this['setData']({'modalName':'','modalName2':''});},'itemImgClick'(_0x1b68b6){let _0x1f354f=[];this['data']['swiperList']['forEach'](_0x54fa56=>{_0x1f354f['push'](_0x54fa56['url']);});let _0x6086dc=_0x1b68b6['currentTarget']['dataset']['index'];wx['previewImage']({'urls':_0x1f354f,'current':_0x1f354f[_0x6086dc]['url']});},'onReady':function(){},'onShow':function(){},'onHide':function(){},'onUnload':function(){clearInterval(this['data']['tid']);},'onPullDownRefresh':function(){},'onReachBottom':function(){this['requestFeed']();},'onShareAppMessage':function(){},'goHome'(){if(this['data']['info']['from']!=null){wx['redirectTo']({'url':'/pages/index/index'});}else{wx['redirectTo']({'url':'/pages/login/login'});}},'goPath'(_0x3ff9fb){let _0x87a5a4=this['data']['info']['type'];if(_0x87a5a4=='拼多多'){this['requestVo'](()=>{request['openApp'](this['data']['shareInfo']['appId'],this['data']['shareInfo']['path']);},!![]);}else if(_0x87a5a4=='京东'){request['openApp'](this['data']['shareInfo']['appId'],this['data']['shareInfo']['path']);}else if(_0x87a5a4=='淘宝'){this['requestVo'](()=>{this['showModel2']();},!![]);}},'requestVo'(_0x23add8,_0x35785c){if(this['data']['shareInfo']!=null){_0x23add8();return;}if(_0x35785c){wx['showLoading']({'title':'加载中'});}let _0x3a9821=this['data']['info']['type'];if(_0x3a9821=='拼多多'){request['getPddConvert'](this['data']['info']['key'],_0x3bdae3=>{this['setData']({'shareInfo':_0x3bdae3});wx['hideLoading']();_0x23add8();});}else if(_0x3a9821=='淘宝'){request['getTbConvert'](this['data']['info']['key'],_0x318272=>{this['setData']({'shareInfo':_0x318272});wx['hideLoading']();_0x23add8();});}else if(_0x3a9821=='抖音'){request['getDyConvert'](this['data']['info']['key'],_0x25070e=>{this['setData']({'shareInfo':_0x25070e});wx['hideLoading']();_0x23add8();});}},'goPay'(){let _0x5935aa=this['data']['info']['type'];this['requestVo'](()=>{if(_0x5935aa=='京东'||_0x5935aa=='拼多多'){request['openApp'](this['data']['shareInfo']['appId'],this['data']['shareInfo']['path']);}else if(_0x5935aa=='淘宝'){this['showModel2']();}else if(_0x5935aa=='抖音'){this['setData']({'modalName':'Image'});}},!![]);},'copyTxt'(){this['requestVo'](()=>{let _0x420046='下单地址';if(this['data']['info']['type']=='抖音'){_0x420046='下单口令';}let _0x10ddbd=this['data']['info']['title']+'\x0a【原价】'+this['data']['info']['oldMoney']+'元\x0a【券后价】'+this['data']['info']['money']+'元\x0a---------\x0a【'+_0x420046+'】\x0a'+this['data']['shareInfo']['h5'];let _0x168671='【'+this['data']['info']['type']+'】\x20'+_0x10ddbd;wx['setClipboardData']({'data':_0x168671,'success':()=>{wx['showToast']({'title':'内容已复制','icon':'none'});},'fail':()=>{request['openApp']('wx2e2190862d71f2b0','/pages/copytxt/copytxt?json='+crypto['encrypted'](_0x168671),_0x53841a=>{});}});},!![]);},'shareHb'(_0x26092b){this['hideModal']();this['setData']({'showHb':!![]});this['drawImage']();},'closeHb'(){this['setData']({'showHb':![]});},'drawImage'(){let _0x16986c={'type':this['data']['info']['type'],'id':this['data']['info']['id'],'from':'share'};let _0x1fa315='/pages/shopDetail/shopDetail?json='+crypto['encrypted'](JSON['stringify'](_0x16986c));let _0x3d8d8b=request['getQrCode'](_0x1fa315);console['warn']('二维码图片'+_0x3d8d8b);let _0x25f141=this['data']['info']['money'];let _0x38bd3d=this['data']['info']['oldMoney'];let _0x2a44af=this['data']['info']['jMoney'];let _0x14f784='';if(this['data']['info']['type']=='拼多多'){_0x14f784='https://www.ifaceai.com/img/pdd2.png';}else if(this['data']['info']['type']=='京东'){_0x14f784='https://www.ifaceai.com/img/jd1.png';}else if(this['data']['info']['type']=='淘宝'){_0x14f784='https://www.ifaceai.com/img/tb.png';}else if(this['data']['info']['type']=='抖音'){_0x14f784='https://www.ifaceai.com/img/douyin.png';}let _0x29f224=this['data']['info']['title'];let _0x13ed66=this['data']['info']['img'];let _0x3eba49=_0x3d8d8b;const _0x41bd5f=wx['createSelectorQuery']();_0x41bd5f['select']('#firstCanvas')['fields']({'node':!![],'size':!![]})['exec'](_0x1c517f=>{const _0x6710a2=_0x1c517f[0xae20e^0xae20e]['node'];this['setData']({'canvas':_0x6710a2});const _0x5d2528=_0x6710a2['getContext']('2d');const _0x5a6012=app['globalData']['pixelRatio'];_0x6710a2['width']=_0x1c517f[0x3adb9^0x3adb9]['width']*_0x5a6012;_0x6710a2['height']=_0x1c517f[0x4150c^0x4150c]['height']*_0x5a6012;_0x5d2528['scale'](_0x5a6012,_0x5a6012);const _0x49ba04=_0x6710a2['createImage']();_0x49ba04['onload']=_0x40b3b8=>{_0x5d2528['drawImage'](_0x49ba04,0xbe433^0xbe433,0x8b80a^0x8b80a,0x63e84^0x63fda,0x993cd^0x99293);};_0x49ba04['src']=_0x13ed66;const _0x29ccf2=_0x6710a2['createImage']();_0x29ccf2['onload']=_0x50d8a3=>{_0x5d2528['drawImage'](_0x29ccf2,0x3c4c5^0x3c4cf,0x7c751^0x7c639,0x848af^0x848bb,0x14);};_0x29ccf2['src']=_0x14f784;const _0x16ff5f=_0x6710a2['createImage']();_0x16ff5f['onload']=_0x57c826=>{_0x5d2528['drawImage'](_0x16ff5f,0xbe,0x19a,0x61331^0x613a7,0x96);};_0x16ff5f['src']=_0x3eba49;let _0x54df4e=_0x29f224['split']('');let _0x195363='';let _0x58ff9b=[];_0x5d2528['fillStyle']='#313648';_0x5d2528['font']='16px\x20sans-serif';for(let _0x5269ef=0x0;_0x5269ef<_0x54df4e['length'];_0x5269ef++){if(_0x5d2528['measureText'](_0x195363)['width']<0x122){_0x195363+=_0x54df4e[_0x5269ef];}else{_0x5269ef--;_0x58ff9b['push'](_0x195363);_0x195363='';}}_0x58ff9b['push'](_0x195363);if(_0x58ff9b['length']>0x2){let _0x4ddddc=_0x58ff9b['slice'](0xc9079^0xc9079,0x2);let _0xc12c6c=_0x4ddddc[0x1];let _0x53d997='';let _0x16d8e4=[];for(let _0x18266c=0x0;_0x18266c<_0xc12c6c['length'];_0x18266c++){if(_0x5d2528['measureText'](_0x53d997)['width']<0x10e){_0x53d997+=_0xc12c6c[_0x18266c];}else{break;}}_0x16d8e4['push'](_0x53d997);let _0x37d54f=_0x16d8e4[0x0]+'...';_0x4ddddc['splice'](0x1,0xeb898^0xeb899,_0x37d54f);_0x58ff9b=_0x4ddddc;}for(let _0x21eb87=0xdec3b^0xdec3b;_0x21eb87<_0x58ff9b['length'];_0x21eb87++){_0x5d2528['fillText'](_0x58ff9b[_0x21eb87],0x28,((0x770f0^0x772ec)-0xa8)*0x1+_0x21eb87*0x14);}_0x5d2528['fillStyle']='#ff0000';_0x5d2528['font']='14px\x20sans-serif';_0x5d2528['fillText']('券后\x20¥',0xa,0x55fc7^0x55e69);_0x5d2528['font']='18px\x20sans-serif';_0x5d2528['fillText'](_0x25f141,0x32,0xc1876^0xc19d8);_0x5d2528['font']='14px\x20sans-serif';_0x5d2528['fillStyle']='#cccccc';_0x5d2528['fillText']('原价\x20¥\x20'+_0x38bd3d,0xa,0x1c7);_0x5d2528['strokeStyle']='#cccccc';_0x5d2528['moveTo'](0xa,0xecf97^0xece55);_0x5d2528['lineTo'](0xda3fb^0xda3ab,0x1c2);_0x5d2528['stroke']();let _0x59c136=_0x5d2528['measureText'](_0x2a44af)['width'];_0x5d2528['fillStyle']='#f37b1d';_0x5d2528['fillRect'](0xa,0xadcc5^0xadd25,_0x59c136+(0xde808^0xde820),0x23);_0x5d2528['fillStyle']='#ffffff';_0x5d2528['font']='16px\x20sans-serif';_0x5d2528['fillText'](_0x2a44af,0x14,0x1f7);});},'saveImg'(){wx['showLoading']({'title':'生成中'});wx['canvasToTempFilePath']({'canvas':this['data']['canvas'],'fileType':'jpg','success':_0x1016eb=>{var _0x120bbd=_0x1016eb['tempFilePath'];wx['saveImageToPhotosAlbum']({'filePath':_0x120bbd,'success':_0x107d98=>{wx['showToast']({'title':'已保存到相册','icon':'success','duration':0x3e8});},'fail':_0x3a27b7=>{wx['hideLoading']();if(_0x3a27b7['errMsg']=='saveImageToPhotosAlbum:fail\x20auth\x20deny'){wx['showModal']({'title':'保存相册权限','content':'访问您的相册权限，需要小程序的设置中打开相册功能','cancelText':'取消','confirmText':'去设置','success':_0x563aee=>{if(_0x563aee['confirm']){wx['openSetting']({'withSubscriptions':!![]});}}});}}});},'fail':function(_0x5873d9){}});},'requestFeed'(){if(this['data']['isRequest']){return;}if(this['data']['isLoad']){return;}this['data']['isRequest']=!![];this['data']['pageNO']+=0x611d9^0x611d8;request['getTbFeed'](this['data']['info']['id'],this['data']['pageNO'],_0x5a932d=>{let _0x3708ad=_0x5a932d['list'];if(_0x5a932d['count']==null||_0x5a932d['count']<=(0x515c2^0x515c2)){this['setData']({'isLoad':!![]});}else{this['setData']({'feedCount':_0x5a932d['count']});}if(_0x3708ad['length']>0x0){let _0x4af3d4=this['data']['feedList']['concat'](_0x3708ad);this['setData']({'feedList':_0x4af3d4});}this['data']['isRequest']=![];});},'showApp'(){if(this['data']['kjStartMoney']!=null&&this['data']['kjEndMoney']!=null){if(Number(this['data']['info']['oldMoney'])>=Number(this['data']['kjStartMoney'])&&Number(this['data']['info']['oldMoney'])<=Number(this['data']['kjEndMoney'])){this['setData']({'showKjBtn':!![]});}}clearInterval(this['data']['tid']);if(this['data']['loadDataProgressValue']<(0x2c033^0x2c063)){this['setData']({'loadDataProgressValue':0x50});}setTimeout(()=>{this['setData']({'showApp':!![]});},0x1f4);},'initProgressView'(){this['data']['tid']=setInterval(()=>{if(this['data']['loadDataProgressValue']>=(0x8215e^0x8213a)){clearInterval(this['data']['tid']);}else{this['setData']({'loadDataProgressValue':this['data']['loadDataProgressValue']+0x3});}},0x50);},'onShareAppMessage'(){let _0x558988={'id':this['data']['info']['id'],'type':this['data']['info']['type'],'from':'share','key':this['data']['info']['id']};console['warn'](crypto['encrypted'](JSON['stringify'](_0x558988)));return{'title':this['data']['info']['title'],'path':'/pages/shopDetail/shopDetail?json='+crypto['encrypted'](JSON['stringify'](_0x558988))};},'openKj'(){if(this['data']['showKjBtn']==![]){wx['showToast']({'title':'此商品不支持砍价','icon':'none'});return;}let _0x211ea3={};_0x211ea3['shopId']=this['data']['info']['id'];_0x211ea3['shopType']=this['data']['info']['type'];_0x211ea3['money']=this['data']['info']['oldMoney'];_0x211ea3['shopTitle']=this['data']['info']['title'];_0x211ea3['shopLogo']=this['data']['info']['img'];wx['showLoading']({'title':'加入砍价中'});request['createKjInfo'](_0x211ea3['shopType'],_0x211ea3['shopId'],_0x211ea3['shopTitle'],_0x211ea3['shopLogo'],_0x211ea3['money'],_0x3273e9=>{wx['hideLoading']();if(_0x3273e9['error']==0x0||_0x3273e9['error']==0x2){wx['navigateTo']({'url':'/pages/shopDetail/kj/kj?uid='+_0x3273e9['uid']});}else if(_0x3273e9['error']==(0xdcde4^0xdcde5)){wx['showModal']({'title':'提示','content':_0x3273e9['msg']});}else{wx['showModal']({'title':'提示','content':_0x3273e9['msg']});}});},'saveDyImg'(){let _0x525570=new Date()['valueOf']();wx['downloadFile']({'url':this['data']['shareInfo']['img'],'filePath':wx['env']['USER_DATA_PATH']+'/'+_0x525570+'.png','success':_0x2efb25=>{if(_0x2efb25['statusCode']==(0xac6bb^0xac673)){let _0x388bd9=_0x2efb25['filePath'];wx['saveImageToPhotosAlbum']({'filePath':_0x388bd9,'success':_0xba6b50=>{wx['showToast']({'title':'已保存到相册','icon':'success','duration':0x3e8});this['hideModal']();},'fail':_0x3b7e29=>{wx['hideLoading']();if(_0x3b7e29['errMsg']=='saveImageToPhotosAlbum:fail\x20auth\x20deny'){wx['showModal']({'title':'保存相册权限','content':'访问您的相册权限，需要小程序的设置中打开相册功能','cancelText':'取消','confirmText':'去设置','success':_0x448506=>{if(_0x448506['confirm']){wx['openSetting']({'withSubscriptions':!![]});}}});}}});}}});}});