/*Obfuscated by JShaman.com*/const app=getApp();var request=require('../../utils/request.js');var QQMapWX=require('../../utils/qqmap-wx-jssdk.min.js');var qqmapsdk=null;Page({'data':{'keyword':'','showSke':!![],'isRequest':![],'pageNO':0x1,'cityList':[],'cityName':'','cateId':null,'cat1Ids':null,'sortType':null,'dealType':null,'lon':null,'lat':null,'cityId':'','txkey':'3DOBZ-F5PKU-UJ2VG-BRSGH-FMQ6J-GSBJT','isLoad':![],'CustomBar':app['globalData']['CustomBar'],'itemList':[],'TabCur':0x0,'distance':null,'scrollLeft':0x0,'type1List':[],'type_item_list':[],'type_active_index':null,'type_list2':[{'dis':0xc8,'name':'附近'},{'dis':0x1f4,'name':'500米'},{'dis':0x3e8,'name':'1000米'},{'dis':0x7d0,'name':'2000米'},{'dis':0xbb8,'name':'3000米'},{'dis':0xfa0,'name':'4000米'},{'dis':0x1388,'name':'5000米'}],'type_list3':[{'id':0x1,'name':'离我最近'},{'id':0xb,'name':'优惠最大'},{'id':0x7,'name':'销量最高'}],'showDataList':[],'allyhbtnlist':[{'id':0x1,'name':'优惠套餐'},{'id':0x2,'name':'代金券'}]},'keyworkEnter'(_0x32be26){let _0x10e1e8=_0x32be26['detail']['keyword'];if(_0x10e1e8['replace'](/(^s*)|(s*$)/g,'')['length']==(0x3c2db^0x3c2db)){_0x10e1e8=null;}this['setData']({'isLoad':![],'isRequest':![],'pageNO':0x1,'keyword':_0x10e1e8});this['requestItemList']();},'inputHand'(_0xc4b13b){let _0x4a4eff=_0xc4b13b['detail']['keyword'];if(_0x4a4eff['replace'](/(^s*)|(s*$)/g,'')['length']==(0x5a896^0x5a896)){this['setData']({'keyword':null});}else{this['setData']({'keyword':_0x4a4eff});}},'typeItemClick'(_0x26d3d2){let _0x46d7ce=_0x26d3d2['currentTarget']['dataset']['index'];if(this['data']['type_active_index']==_0x46d7ce){this['setData']({'type_active_index':null,'type_item_list':[]});return;}if(_0x46d7ce==(0x200a0^0x200a0)){this['setData']({'type_active_index':_0x46d7ce,'type_item_list':this['data']['type1List'][this['data']['TabCur']]['subcate']});}else if(_0x46d7ce==(0x455d8^0x455d9)){this['setData']({'type_active_index':_0x46d7ce});}else if(_0x46d7ce==(0xe5674^0xe5676)){this['setData']({'type_active_index':_0x46d7ce});}else if(_0x46d7ce==(0x632c2^0x632c1)){this['setData']({'type_active_index':_0x46d7ce});}},'subTypeItemHand'(_0x1aed5c){this['setData']({'cat1Ids':_0x1aed5c['currentTarget']['dataset']['id'],'isLoad':![],'isRequest':![],'showDataList':[],'pageNO':0x1,'type_active_index':null});this['requestItemList']();},'subDisItemHand'(_0x2c805b){this['setData']({'distance':_0x2c805b['currentTarget']['dataset']['dis'],'isLoad':![],'isRequest':![],'showDataList':[],'pageNO':0x1,'type_active_index':null});this['requestItemList']();},'subJuItemHand'(_0x315c0e){this['setData']({'sortType':_0x315c0e['currentTarget']['dataset']['id'],'isLoad':![],'isRequest':![],'showDataList':[],'pageNO':0x1,'type_active_index':null});this['requestItemList']();},'subSxItemHand'(_0x4e5f66){this['setData']({'dealType':_0x4e5f66['currentTarget']['dataset']['id'],'isLoad':![],'isRequest':![],'showDataList':[],'pageNO':0x1,'type_active_index':null});this['requestItemList']();},'tabSelect'(_0x4847d8){this['setData']({'TabCur':_0x4847d8['currentTarget']['dataset']['index'],'scrollLeft':(_0x4847d8['currentTarget']['dataset']['index']-(0xb93eb^0xb93ea))*(0xac60f^0xac65a),'type_active_index':null,'cateId':_0x4847d8['currentTarget']['dataset']['id'],'cat1Ids':null,'isLoad':![],'isRequest':![],'pageNO':0x1,'showDataList':[]});this['requestItemList']();},'onLoad':function(_0x40a4ec){qqmapsdk=new QQMapWX({'key':this['data']['txkey']});this['getLocation']();},'getLocation'(){request['getLocation'](_0x2e7784=>{this['data']['lon']=_0x2e7784['lon'];this['data']['lat']=_0x2e7784['lat'];qqmapsdk['reverseGeocoder']({'location':{'latitude':_0x2e7784['lat'],'longitude':_0x2e7784['lon']},'success':_0x2ad9e3=>{let _0x53b091=_0x2ad9e3['result']['ad_info']['city'];let _0x3d593d=null;request['getMtCityList'](_0x230256=>{_0x230256['forEach']((_0x1ee4ec,_0x26c27d)=>{_0x1ee4ec['list']['forEach']((_0x46437c,_0x6d7bad)=>{if(_0x53b091['indexOf'](_0x46437c['name'])!=-(0xd58e5^0xd58e4)||_0x46437c['name']['indexOf'](_0x53b091)!=-(0xafc92^0xafc93)){_0x53b091=_0x46437c['name'];_0x3d593d=_0x46437c['id'];}});});this['setData']({'cityName':_0x53b091,'cityId':_0x3d593d});this['requestType']();});}});});},'requestType'(){request['getMtPoiType'](this['data']['cityId'],_0x2f22e9=>{console['warn'](_0x2f22e9);_0x2f22e9['sort']((_0x8e8a56,_0x230dc4)=>{if(_0x8e8a56['id']<_0x230dc4['id']){return-0x1;}else if(_0x8e8a56['id']>_0x230dc4['id']){return 0x1;}return 0x0;});_0x2f22e9['forEach']((_0x15d018,_0x65f3c)=>{if(_0x15d018['name']['length']>(0x8c181^0x8c185)){_0x15d018['name']=_0x15d018['name']['substring'](0x0,0x894c2^0x894c6);}});this['setData']({'type1List':_0x2f22e9});this['requestMsList']();this['requestItemList']();});},'requestItemList'(){if(this['data']['isLoad']||this['data']['isRequest']){return;}if(this['data']['pageNO']==(0xb44ee^0xb44ef)){this['setData']({'showSke':!![]});}let _0x699f41=this['getParams']();this['data']['isRequest']=!![];request['searchMtDeals'](_0x699f41['pageNO'],_0x699f41['catId'],_0x699f41['cat1Ids'],_0x699f41['lon'],_0x699f41['lat'],_0x699f41['cityId'],_0x699f41['distance'],_0x699f41['keyword'],_0x699f41['sortType'],0xdd6b1^0xdd6b3,_0x699f41['dealType'],_0x56e78b=>{this['data']['isRequest']=![];let _0x2518d2=_0x56e78b['records'];if(_0x2518d2['length']<=(0x71c93^0x71c93)){this['setData']({'isLoad':!![]});}let _0x5da537=this['data']['showDataList']['concat'](_0x2518d2);this['setData']({'showDataList':_0x5da537,'showSke':![]});if(this['data']['showDataList']['length']<0x4){this['setData']({'isLoad':!![]});}});},'getParams'(){let _0x2e20bc={'lon':this['data']['lon'],'lat':this['data']['lat']};_0x2e20bc['cityId']=this['data']['cityId'];_0x2e20bc['catId']=this['data']['type1List'][this['data']['TabCur']]['id'];if(this['data']['cat1Ids']!=null&&this['data']['cat1Ids']!=''){_0x2e20bc['cat1Ids']=this['data']['cat1Ids'];}_0x2e20bc['pageNO']=this['data']['pageNO'];_0x2e20bc['distance']=this['data']['distance'];_0x2e20bc['sortType']=this['data']['sortType'];_0x2e20bc['dealType']=this['data']['dealType'];_0x2e20bc['keyword']=this['data']['keyword'];return _0x2e20bc;},'requestMsList'(){request['searchDdxMsPoit'](this['data']['cityId'],0x4d2c4^0x4d2c5,this['data']['lon'],this['data']['lat'],0x1,_0x4a04db=>{let _0x1da71d=_0x4a04db['data']['poiList'];let _0x4d695a=[];_0x1da71d['forEach']((_0x5d5bf8,_0x37cf13)=>{let _0x35e4da={};_0x35e4da['img']=_0x5d5bf8['seckillShopDealInfoVO']['dealList'][0xebd68^0xebd68]['imgUrl'];_0x35e4da['title']=_0x5d5bf8['seckillShopDealInfoVO']['cateName'];_0x35e4da['remark']='评分'+_0x5d5bf8['seckillShopDealInfoVO']['avgScore'];_0x35e4da['zk']=_0x5d5bf8['seckillShopDealInfoVO']['dealList'][0x0]['finalPrice']/(0xedaca^0xedaae)+'元';_0x35e4da['path']=_0x5d5bf8['seckillShopDealInfoVO']['dealList'][0x23ec1^0x23ec1]['miniProgramUrl'];_0x35e4da['info']=_0x5d5bf8;_0x4d695a['push'](_0x35e4da);});this['setData']({'itemList':_0x4d695a});});},'msItemClickHand'(_0x344c37){let _0x27544d=this['data']['itemList'][_0x344c37['currentTarget']['dataset']['index']]['info'];app['tmp']=_0x27544d;wx['navigateTo']({'url':'/pages/index2/shopNameDetail/shopNameDetail'});},'shopItemClickHand'(_0x2fa849){let _0x183f8e=_0x2fa849['currentTarget']['dataset']['index'];let _0xe46b99=this['data']['showDataList'][_0x183f8e];let _0x469f27=_0xe46b99['shopInfo']['shopId'];wx['navigateTo']({'url':'/pages/index2/mtPoiDetail/mtPoiDetail?shopId='+_0x469f27});},'openMore'(){wx['navigateTo']({'url':'/pages/index2/shopNameMore/shopNameMore?cityId='+this['data']['cityId']+'&lon='+this['data']['lon']+'&lat='+this['data']['lat']});},'onReady':function(){},'onShow':function(){},'onHide':function(){},'onUnload':function(){},'onPullDownRefresh':function(){},'onReachBottom':function(){if(this['data']['isLoad']||this['data']['isRequest']){return;}this['data']['pageNO']++;this['requestItemList']();},'onShareAppMessage':function(){},'titleClick'(){wx['navigateTo']({'url':'/pages/city/city'});},'refreshCity'(_0x16dd6b,_0x268155){this['setData']({'cityId':_0x16dd6b,'cityName':_0x268155,'itemList':[],'isLoad':![],'isRequest':![],'showDataList':[],'pageNO':0x1,'type_active_index':null});this['requestMsList']();this['requestItemList']();}});