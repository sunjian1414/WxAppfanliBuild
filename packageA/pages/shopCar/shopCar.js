/*Obfuscated by JShaman.com*/const app=getApp();var request=require('../../../utils/request.js');var crypto=require('../../../utils/crypto.js');function trim(_0x2281ac){_0x2281ac=_0x2281ac+'';if(_0x2281ac==''){return _0x2281ac;}if(_0x2281ac!=undefined&&_0x2281ac!=null&&_0x2281ac!=''){return _0x2281ac['replace'](/(^\s*)|(\s*$)/g,'');}return _0x2281ac;}Page({'data':{'showLoadingAddress':![],'addressId':null,'addressTxt':'','_ch':0x0,'CustomBar':app['globalData']['CustomBar'],'showTip':![],'list':[],'countmoney':'0.0','countscore':0x0,'payAllCount':0x0,'payType':0x1,'modalName':null},'goScore'(){this['setData']({'modalName':'bottomModalScore','payType':0x0});},'goMoney'(){this['setData']({'modalName':'bottomModalScore','payType':0x1});},'onLoad'(_0x33ff85){this['setData']({'_ch':app['globalData']['clientHeight']-this['data']['CustomBar']-(0xc02c0^0xc0290)});let _0x15883f=wx['getStorageSync']('carList');if(_0x15883f==undefined||_0x15883f['length']<=(0x69b30^0x69b30)){this['setData']({'showTip':!![]});return;}request['searchModDetailBatch'](_0x15883f['join'](','),_0x13d569=>{this['setData']({'list':_0x13d569['list']});console['warn'](_0x13d569['list']);});},'delHand'(){if(this['data']['list']['length']<=(0x7dbf1^0x7dbf1)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x5b1f4e=[];this['data']['list']['forEach']((_0x10af34,_0x38bec0)=>{_0x10af34['list']['forEach']((_0x1daaf0,_0x5d2a5e)=>{if(_0x1daaf0['check']){_0x5b1f4e['push'](_0x1daaf0['uid']);}});});if(_0x5b1f4e['length']<=(0xe490d^0xe490d)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x45757c=wx['getStorageSync']('carList');for(let _0x73e251=_0x45757c['length']-(0x4d237^0x4d236);_0x73e251>=(0xa70c6^0xa70c6);_0x73e251--){let _0x42a542=![];_0x5b1f4e['forEach']((_0x5a7fcd,_0x402b1d)=>{if(_0x5a7fcd==_0x45757c[_0x73e251]){_0x42a542=!![];}});if(_0x42a542){_0x45757c['splice'](_0x73e251,0xe207e^0xe207f);}}this['data']['list']['forEach']((_0x10423d,_0x4e4438)=>{for(let _0x3f214a=_0x10423d['list']['length']-(0x36404^0x36405);_0x3f214a>=(0x8fb63^0x8fb63);_0x3f214a--){let _0x499d62=![];_0x5b1f4e['forEach']((_0x11ce80,_0xb024df)=>{if(_0x11ce80==_0x10423d['list'][_0x3f214a]['uid']){_0x499d62=!![];}});if(_0x499d62){_0x10423d['list']['splice'](_0x3f214a,0x67540^0x67541);}}});for(let _0x3fef88=this['data']['list']['length']-0x1;_0x3fef88>=0x0;_0x3fef88--){if(this['data']['list'][_0x3fef88]['list']['length']<=(0x6f69c^0x6f69c)){this['data']['list']['splice'](_0x3fef88,0x57422^0x57423);}}this['setData']({'list':this['data']['list']});if(_0x45757c['length']<=(0xeccb5^0xeccb5)){this['setData']({'showTip':!![]});}if(_0x45757c['length']>0x0){wx['setStorageSync']('carList',_0x45757c);}else{wx['removeStorage']({'key':'carList'});}this['refreshPayMoney']();},'itemChange'(_0xcf2a51){let _0xebb6=_0xcf2a51['detail']['value'];this['data']['list']['forEach']((_0x36ee1b,_0x3d88fd)=>{_0x36ee1b['list']['forEach']((_0x23442a,_0x3e8d5c)=>{_0x23442a['check']=![];});});_0xebb6['forEach']((_0xcb5070,_0x4854fb)=>{this['refreshItemCheck'](_0xcb5070);});this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'selectAllChange'(_0x5b6a9f){let _0xca8e1d=_0x5b6a9f['detail']['value'];if(_0xca8e1d['length']>0x0){this['data']['list']['forEach']((_0x59badd,_0x4e6c6b)=>{_0x59badd['list']['forEach']((_0x5e8147,_0x170f3b)=>{_0x5e8147['check']=!![];});});}else{this['data']['list']['forEach']((_0x8ce071,_0x49cdc2)=>{_0x8ce071['list']['forEach']((_0xf3216e,_0x50277)=>{_0xf3216e['check']=![];});});}this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'refreshItemCheck'(_0x3b6dc8){this['data']['list']['forEach']((_0x411f80,_0x219054)=>{_0x411f80['list']['forEach']((_0x545c89,_0x35d851)=>{if(_0x3b6dc8==_0x545c89['uid']){_0x545c89['check']=!![];}});});},'refreshPayMoney'(){let _0x201f33=0x0;let _0xb659b7=0xaa596^0xaa596;let _0x4f4615=0x0;this['data']['list']['forEach']((_0x285fc1,_0x1251c9)=>{_0x285fc1['list']['forEach']((_0xe18b96,_0x2664ce)=>{if(_0xe18b96['check']){_0x201f33+=_0xe18b96['price']*_0xe18b96['payCount'];_0xb659b7+=_0xe18b96['score'];_0x4f4615+=_0xe18b96['payCount'];}});});this['setData']({'payAllCount':_0x4f4615,'countmoney':_0x201f33['toFixed'](0x633d4^0x633d5),'countscore':_0xb659b7});},'goHome'(){wx['switchTab']({'url':'/pages/home/home'});},'stepChangeHand'(_0x5a1e4b){let _0x5b83be=_0x5a1e4b['detail']['value'];let _0x24ce5c=_0x5a1e4b['detail']['index'];this['data']['list']['forEach']((_0x3bdecb,_0x5ba248)=>{_0x3bdecb['list']['forEach']((_0x55a152,_0x725e8e)=>{if(_0x55a152['uid']==_0x24ce5c){_0x55a152['payCount']=_0x5b83be;_0x55a152['showPrice']=(_0x5b83be*_0x55a152['price'])['toFixed'](0xc7880^0xc7881);}});});this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'hideModal'(){this['setData']({'modalName':null});},'hejiHand'(_0x56f740){if(this['data']['list']['length']<=0x0){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x2beea8=[];this['data']['list']['forEach']((_0x5eda3d,_0x2b7257)=>{_0x5eda3d['list']['forEach']((_0x567be4,_0x4d48b5)=>{if(_0x567be4['check']){_0x2beea8['push'](_0x567be4['uid']);}});});if(_0x2beea8['length']<=0x0){wx['showToast']({'title':'未选择商品','icon':'none'});return;}this['setData']({'modalName':'bottomModalScore'});},'onReady'(){},'onShow'(){},'onHide'(){},'onUnload'(){var _0x287828=getCurrentPages();var _0x145dac=_0x287828[_0x287828['length']-(0xdfbd1^0xdfbd3)];_0x145dac['refreshCarshop']();},'itemClick'(_0x25344e){let _0xfeb0d0=_0x25344e['currentTarget']['dataset']['uid'];wx['navigateTo']({'url':'/pages/home/shopDetail/shopDetail?id='+_0xfeb0d0});},'refreshCarshop'(){},'openAddress'(){wx['navigateTo']({'url':'/packageA/pages/address/address'});},'refreshAddress'(){this['setData']({'showLoadingAddress':!![]});request['searchUserDefaultAddressInfo'](_0x47c646=>{if(_0x47c646['error']==0x0&&_0x47c646['data']!=null){this['data']['addressTxt']=this['createShowAddress'](_0x47c646['data']);this['setData']({'addressId':_0x47c646['data']['uid'],'addressTxt':this['data']['addressTxt']});}else{this['setData']({'addressId':null,'addressTxt':''});}this['setData']({'showLoadingAddress':![]});});},'createShowAddress'(_0x3ea7ed){_0x3ea7ed['_userName']=_0x3ea7ed['userName']['charAt'](0x0)+'*';_0x3ea7ed['_telNumber']=_0x3ea7ed['telNumber']['substring'](0x0,0x3)+'****'+_0x3ea7ed['telNumber']['substring'](0x518a4^0x518a3);_0x3ea7ed['_provinceName']=_0x3ea7ed['provinceName']['charAt'](0x25901^0x25901)+'***'+_0x3ea7ed['provinceName']['charAt'](_0x3ea7ed['provinceName']['length']-(0xe1aee^0xe1aef));_0x3ea7ed['_cityName']=_0x3ea7ed['cityName']['charAt'](0x6d5ff^0x6d5ff)+'***'+_0x3ea7ed['cityName']['charAt'](_0x3ea7ed['cityName']['length']-0x1);_0x3ea7ed['_countryName']='***'+_0x3ea7ed['countryName']['charAt'](_0x3ea7ed['countryName']['length']-0x1);_0x3ea7ed['_detailInfo']=trim(_0x3ea7ed['detailInfo'])['charAt'](0x0);_0x3ea7ed['_detailInfo']=_0x3ea7ed['_detailInfo']+'***'+trim(_0x3ea7ed['detailInfo'])['charAt'](_0x3ea7ed['detailInfo']['length']-(0xd219f^0xd219e))+'***';return _0x3ea7ed['_provinceName']+_0x3ea7ed['_cityName']+_0x3ea7ed['_countryName']+_0x3ea7ed['_detailInfo'];},'submitHand'(){if(this['data']['addressId']==null||this['data']['addressId']==''){wx['showToast']({'title':'请选择收货地收','icon':'none'});return;}let _0x253034=[];this['data']['list']['forEach']((_0x10296e,_0x3535dc)=>{_0x10296e['list']['forEach']((_0x2590ba,_0x5b8c9f)=>{if(_0x2590ba['check']){_0x253034['push']({'uid':_0x2590ba['uid'],'payCount':_0x2590ba['payCount']});}});});if(this['data']['payType']==0x0){wx['showLoading']({'title':'支付中'});request['payScoreShopBatch'](_0x253034,this['data']['addressId'],_0x589e4e=>{wx['hideLoading']();if(_0x589e4e['error']==(0x3d2d6^0x3d2d6)){this['hideModal']();this['delHand']();wx['showModal']({'title':'提示','content':'兑换成功,是否前往订单页查看','showCancel':!![],'confirmText':'查看','success':_0x532077=>{if(_0x532077['confirm']){wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});}else{wx['showToast']({'title':_0x589e4e['msg'],'icon':'none'});}});}else if(this['data']['payType']==0x1){let _0x4d55aa={'positionId':app['globalData']['userInfo']['positionId']};_0x4d55aa['fromType']='payBatchMod';_0x4d55aa['addressId']=this['data']['addressId'];_0x4d55aa['arr']=_0x253034;request['openApp']('wx2e2190862d71f2b0','/pages/paymonth/paymonth?json='+crypto['encrypted'](JSON['stringify'](_0x4d55aa)),_0x2b4a81=>{wx['showModal']({'title':'支付操作','content':'请确认您是否已完成支付操作','cancelText':'取消支付','confirmText':'完成支付','confirmColor':'#07c160','success':_0x111d7c=>{this['hideModal']();if(_0x111d7c['confirm']){this['hideModal']();this['delHand']();wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});});return;wx['showLoading']({'title':'支付中'});request['payModBatch'](_0x253034,this['data']['addressId'],_0x314e2b=>{wx['hideLoading']();if(_0x314e2b['error']==0x1){wx['showModal']({'title':'提示','content':_0x314e2b['msg'],'showCancel':![]});return;}wx['requestPayment']({'timeStamp':_0x314e2b['timeStamp'],'nonceStr':_0x314e2b['nonceStr'],'package':_0x314e2b['package'],'signType':_0x314e2b['signType'],'paySign':_0x314e2b['paySign'],'success':_0x54c67a=>{if(_0x54c67a['errMsg']=='requestPayment:ok'){wx['showModal']({'title':'支付操作','content':'请确认您是否已完成支付操作','cancelText':'取消支付','confirmText':'完成支付','confirmColor':'#07c160','success':_0x3b795b=>{this['hideModal']();if(_0x3b795b['confirm']){this['hideModal']();this['delHand']();wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});}else{wx['showToast']({'title':_0x54c67a['errMsg'],'icon':'none'});}},'fail':_0x55699a=>{if(_0x55699a['errMsg']=='requestPayment:fail\x20cancel'){wx['showToast']({'title':'已取消支付','icon':'none'});}else{wx['showToast']({'title':_0x55699a['errMsg'],'icon':'none'});}}});});}},'onPullDownRefresh'(){},'onReachBottom'(){},'onShareAppMessage'(){}});