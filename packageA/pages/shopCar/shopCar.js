/*Obfuscated by JShaman.com*/const app=getApp();var request=require('../../../utils/request.js');var crypto=require('../../../utils/crypto.js');function trim(_0x1b7350){_0x1b7350=_0x1b7350+'';if(_0x1b7350==''){return _0x1b7350;}if(_0x1b7350!=undefined&&_0x1b7350!=null&&_0x1b7350!=''){return _0x1b7350['replace'](/(^\s*)|(\s*$)/g,'');}return _0x1b7350;}Page({'data':{'showPay':!![],'showLoadingAddress':![],'addressId':null,'addressTxt':'','_ch':0x0,'CustomBar':app['globalData']['CustomBar'],'showTip':![],'list':[],'countmoney':'0.0','countscore':0x0,'payAllCount':0x0,'payType':0x0,'modalName':null},'goScore'(){this['setData']({'modalName':'bottomModalScore','payType':0x0});},'goMoney'(){this['setData']({'modalName':'bottomModalScore','payType':0x1});},'onLoad'(_0x300904){if(app['globalData']['apiInfo']['showPay']==(0x58273^0x58273)){this['setData']({'showPay':!![]});}else{this['setData']({'showPay':![]});}this['setData']({'_ch':app['globalData']['clientHeight']-this['data']['CustomBar']-(0x357fc^0x357ac)});let _0x1ccaab=wx['getStorageSync']('carList');if(_0x1ccaab==undefined||_0x1ccaab['length']<=(0x8ca6c^0x8ca6c)){this['setData']({'showTip':!![]});return;}request['searchModDetailBatch'](_0x1ccaab['join'](','),_0x355e58=>{this['setData']({'list':_0x355e58['list']});console['warn'](_0x355e58['list']);});},'delHand'(){if(this['data']['list']['length']<=(0xbce5e^0xbce5e)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x573642=[];this['data']['list']['forEach']((_0x3a620b,_0x4cff9c)=>{_0x3a620b['list']['forEach']((_0x242660,_0x190550)=>{if(_0x242660['check']){_0x573642['push'](_0x242660['uid']);}});});if(_0x573642['length']<=(0x19e67^0x19e67)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x3f4198=wx['getStorageSync']('carList');for(let _0x4a61c0=_0x3f4198['length']-(0x8e782^0x8e783);_0x4a61c0>=(0xa195e^0xa195e);_0x4a61c0--){let _0x3d074d=![];_0x573642['forEach']((_0x35d4c6,_0x232d51)=>{if(_0x35d4c6==_0x3f4198[_0x4a61c0]){_0x3d074d=!![];}});if(_0x3d074d){_0x3f4198['splice'](_0x4a61c0,0x9558b^0x9558a);}}this['data']['list']['forEach']((_0x28a6ca,_0x5a5d4a)=>{for(let _0x97058c=_0x28a6ca['list']['length']-(0x7281a^0x7281b);_0x97058c>=(0xd0e38^0xd0e38);_0x97058c--){let _0x4af45c=![];_0x573642['forEach']((_0x29b5c7,_0x387894)=>{if(_0x29b5c7==_0x28a6ca['list'][_0x97058c]['uid']){_0x4af45c=!![];}});if(_0x4af45c){_0x28a6ca['list']['splice'](_0x97058c,0x1);}}});for(let _0x85f0dd=this['data']['list']['length']-(0xc1abe^0xc1abf);_0x85f0dd>=0x0;_0x85f0dd--){if(this['data']['list'][_0x85f0dd]['list']['length']<=(0x61d84^0x61d84)){this['data']['list']['splice'](_0x85f0dd,0x1);}}this['setData']({'list':this['data']['list']});if(_0x3f4198['length']<=0x0){this['setData']({'showTip':!![]});}if(_0x3f4198['length']>(0xdb136^0xdb136)){wx['setStorageSync']('carList',_0x3f4198);}else{wx['removeStorage']({'key':'carList'});}this['refreshPayMoney']();},'itemChange'(_0x32218f){let _0x98e579=_0x32218f['detail']['value'];this['data']['list']['forEach']((_0x2d6e1a,_0x5a65d4)=>{_0x2d6e1a['list']['forEach']((_0x5c3067,_0x17387d)=>{_0x5c3067['check']=![];});});_0x98e579['forEach']((_0xce52e3,_0x35c31a)=>{this['refreshItemCheck'](_0xce52e3);});this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'selectAllChange'(_0x17ba02){let _0x1dd46e=_0x17ba02['detail']['value'];if(_0x1dd46e['length']>(0x82bbc^0x82bbc)){this['data']['list']['forEach']((_0x2024d5,_0x93f5ea)=>{_0x2024d5['list']['forEach']((_0x893e59,_0x3dc26c)=>{_0x893e59['check']=!![];});});}else{this['data']['list']['forEach']((_0x1ba480,_0x57f388)=>{_0x1ba480['list']['forEach']((_0x3b86e5,_0x221808)=>{_0x3b86e5['check']=![];});});}this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'refreshItemCheck'(_0x1c4d8b){this['data']['list']['forEach']((_0x476b33,_0x55dfab)=>{_0x476b33['list']['forEach']((_0x52b7eb,_0x3ae588)=>{if(_0x1c4d8b==_0x52b7eb['uid']){_0x52b7eb['check']=!![];}});});},'refreshPayMoney'(){let _0x5a2696=0x9e920^0x9e920;let _0x35352a=0x0;let _0x5c32ed=0x34036^0x34036;this['data']['list']['forEach']((_0x4d6abf,_0x3c8200)=>{_0x4d6abf['list']['forEach']((_0xca9dee,_0x324c74)=>{if(_0xca9dee['check']){_0x5a2696+=_0xca9dee['price']*_0xca9dee['payCount'];_0x35352a+=_0xca9dee['score'];_0x5c32ed+=_0xca9dee['payCount'];}});});this['setData']({'payAllCount':_0x5c32ed,'countmoney':_0x5a2696['toFixed'](0x1),'countscore':_0x35352a});},'goHome'(){wx['switchTab']({'url':'/pages/home/home'});},'stepChangeHand'(_0x4c1221){let _0xbb188f=_0x4c1221['detail']['value'];let _0x1ad5f9=_0x4c1221['detail']['index'];this['data']['list']['forEach']((_0x26b039,_0x4950fc)=>{_0x26b039['list']['forEach']((_0x2ee865,_0x36b25c)=>{if(_0x2ee865['uid']==_0x1ad5f9){_0x2ee865['payCount']=_0xbb188f;_0x2ee865['showPrice']=(_0xbb188f*_0x2ee865['price'])['toFixed'](0x1);}});});this['setData']({'list':this['data']['list']});this['refreshPayMoney']();},'hideModal'(){this['setData']({'modalName':null});},'hejiHand'(_0x520a2e){if(this['data']['list']['length']<=(0x623fc^0x623fc)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}let _0x334963=[];this['data']['list']['forEach']((_0x54c587,_0xaba386)=>{_0x54c587['list']['forEach']((_0x545a8d,_0x3e30b9)=>{if(_0x545a8d['check']){_0x334963['push'](_0x545a8d['uid']);}});});if(_0x334963['length']<=(0xe52f4^0xe52f4)){wx['showToast']({'title':'未选择商品','icon':'none'});return;}this['setData']({'modalName':'bottomModalScore'});},'onReady'(){},'onShow'(){},'onHide'(){},'onUnload'(){var _0x3fc76c=getCurrentPages();var _0x456028=_0x3fc76c[_0x3fc76c['length']-(0xad4a8^0xad4aa)];_0x456028['refreshCarshop']();},'itemClick'(_0x16184d){let _0x4719a4=_0x16184d['currentTarget']['dataset']['uid'];wx['navigateTo']({'url':'/pages/home/shopDetail/shopDetail?id='+_0x4719a4});},'refreshCarshop'(){},'openAddress'(){wx['navigateTo']({'url':'/packageA/pages/address/address'});},'refreshAddress'(){this['setData']({'showLoadingAddress':!![]});request['searchUserDefaultAddressInfo'](_0x13a1bc=>{if(_0x13a1bc['error']==(0xdb0d3^0xdb0d3)&&_0x13a1bc['data']!=null){this['data']['addressTxt']=this['createShowAddress'](_0x13a1bc['data']);this['setData']({'addressId':_0x13a1bc['data']['uid'],'addressTxt':this['data']['addressTxt']});}else{this['setData']({'addressId':null,'addressTxt':''});}this['setData']({'showLoadingAddress':![]});});},'createShowAddress'(_0x52c14f){_0x52c14f['_userName']=_0x52c14f['userName']['charAt'](0x99b7b^0x99b7b)+'*';_0x52c14f['_telNumber']=_0x52c14f['telNumber']['substring'](0x0,0x3)+'****'+_0x52c14f['telNumber']['substring'](0x4c66a^0x4c66d);_0x52c14f['_provinceName']=_0x52c14f['provinceName']['charAt'](0x0)+'***'+_0x52c14f['provinceName']['charAt'](_0x52c14f['provinceName']['length']-(0xc8dcf^0xc8dce));_0x52c14f['_cityName']=_0x52c14f['cityName']['charAt'](0x0)+'***'+_0x52c14f['cityName']['charAt'](_0x52c14f['cityName']['length']-0x1);_0x52c14f['_countryName']='***'+_0x52c14f['countryName']['charAt'](_0x52c14f['countryName']['length']-(0xc875b^0xc875a));_0x52c14f['_detailInfo']=trim(_0x52c14f['detailInfo'])['charAt'](0x0);_0x52c14f['_detailInfo']=_0x52c14f['_detailInfo']+'***'+trim(_0x52c14f['detailInfo'])['charAt'](_0x52c14f['detailInfo']['length']-0x1)+'***';return _0x52c14f['_provinceName']+_0x52c14f['_cityName']+_0x52c14f['_countryName']+_0x52c14f['_detailInfo'];},'submitHand'(){if(this['data']['addressId']==null||this['data']['addressId']==''){wx['showToast']({'title':'请选择收货地收','icon':'none'});return;}let _0x1fbd0c=[];this['data']['list']['forEach']((_0x3c3cde,_0x555028)=>{_0x3c3cde['list']['forEach']((_0x5e13ae,_0xaf9f07)=>{if(_0x5e13ae['check']){_0x1fbd0c['push']({'uid':_0x5e13ae['uid'],'payCount':_0x5e13ae['payCount']});}});});if(this['data']['payType']==0x0){wx['showLoading']({'title':'支付中'});request['payScoreShopBatch'](_0x1fbd0c,this['data']['addressId'],_0x23bf76=>{wx['hideLoading']();if(_0x23bf76['error']==0x0){this['hideModal']();this['delHand']();wx['showModal']({'title':'提示','content':'兑换成功,是否前往订单页查看','showCancel':!![],'confirmText':'查看','success':_0x2e34ed=>{if(_0x2e34ed['confirm']){wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});}else{wx['showToast']({'title':_0x23bf76['msg'],'icon':'none'});}});}else if(this['data']['payType']==(0x53ba0^0x53ba1)){let _0x1e7fce={'positionId':app['globalData']['userInfo']['positionId']};_0x1e7fce['fromType']='payBatchMod';_0x1e7fce['addressId']=this['data']['addressId'];_0x1e7fce['arr']=_0x1fbd0c;request['openApp']('wx2e2190862d71f2b0','/pages/paymonth/paymonth?json='+crypto['encrypted'](JSON['stringify'](_0x1e7fce)),_0x1dfb42=>{wx['showModal']({'title':'支付操作','content':'请确认您是否已完成支付操作','cancelText':'取消支付','confirmText':'完成支付','confirmColor':'#07c160','success':_0x39dabb=>{this['hideModal']();if(_0x39dabb['confirm']){this['hideModal']();this['delHand']();wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});});return;wx['showLoading']({'title':'支付中'});request['payModBatch'](_0x1fbd0c,this['data']['addressId'],_0x5b72a8=>{wx['hideLoading']();if(_0x5b72a8['error']==(0x7243d^0x7243c)){wx['showModal']({'title':'提示','content':_0x5b72a8['msg'],'showCancel':![]});return;}wx['requestPayment']({'timeStamp':_0x5b72a8['timeStamp'],'nonceStr':_0x5b72a8['nonceStr'],'package':_0x5b72a8['package'],'signType':_0x5b72a8['signType'],'paySign':_0x5b72a8['paySign'],'success':_0x4e7284=>{if(_0x4e7284['errMsg']=='requestPayment:ok'){wx['showModal']({'title':'支付操作','content':'请确认您是否已完成支付操作','cancelText':'取消支付','confirmText':'完成支付','confirmColor':'#07c160','success':_0x2329dd=>{this['hideModal']();if(_0x2329dd['confirm']){this['hideModal']();this['delHand']();wx['navigateTo']({'url':'/packageA/pages/orderHistory/dhOrderHistory/dhOrderHistory'});}}});}else{wx['showToast']({'title':_0x4e7284['errMsg'],'icon':'none'});}},'fail':_0x525425=>{if(_0x525425['errMsg']=='requestPayment:fail\x20cancel'){wx['showToast']({'title':'已取消支付','icon':'none'});}else{wx['showToast']({'title':_0x525425['errMsg'],'icon':'none'});}}});});}},'onPullDownRefresh'(){},'onReachBottom'(){},'onShareAppMessage'(){}});